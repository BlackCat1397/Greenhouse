<!DOCTYPE html>
<html lang="ru">
  <head>
    <title>Plans - Greenhouse-systems</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="../css/styles.css">    
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../css/open-iconic-bootstrap.css">
  </head>

  <header>
    <nav class="navbar navbar-expand-sm navbar-dark bg-dark--green">
      <a class="navbar-brand" href="../index.html">Greenhouse Systems(tm)</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="../index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../spectrate/status.html">Status</span></a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              History
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="../spectrate/plots.html">Plots</a>
              <a class="dropdown-item" href="../spectrate/log.html">Log</a>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="status.html">Plans <span class="sr-only">(current)</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../equipment/status.html">Equipment</a>
          </li>
        </ul>
      </div>
    </nav>
  </header>

  <body>
    <div class="container-fluid">
      <h1>Plans</h1>
      <div class="plan">
        <h2><input type="text" class="plan-name" value="Tulips - plan"><span class="oi oi-trash oi-trash-period" title="trash" aria-hidden="true" id="del-plan-1"></span></h2>
        <div class="row">
          <div class="col-lg-7">
            <table class="table table-responsive table-striped plan">
              <thead>
                <tr>
                  <th scope="col">Parameters</th>
                  <th scope="col">Duration (hours): </th>
                  <th scope="col">Air temperature: </th>
                  <th scope="col">Humidity: </th>
                  <th scope="col">PH: </th>
                  <th colspan="2"></th>
                </tr>
              </thead>
              <tbody id="demo1">
                <tr class="draggable demo-no-swipe">
                  <th scope="row">Period 1</th>
                  <td>120</td>
                  <td>22</td>
                  <td>92%</td>
                  <td>5.6</td>
                  <td><span class="oi oi-pencil" title="pencil" aria-hidden="true"></span></td>
                  <td><span class="oi oi-trash" title="trash" aria-hidden="true" data-id="del-icon"></span></td>
                </tr>
                <tr class="draggable demo-no-swipe">
                  <th scope="row">Period 2</th>
                  <td>96</td>
                  <td>24</td>
                  <td>86%</td>
                  <td>5.7</td>
                  <td><span class="oi oi-pencil" title="pencil" aria-hidden="true"></span></td>
                  <td><span class="oi oi-trash" title="trash" aria-hidden="true" data-id="del-icon"></span></td>
                </tr>
                <tr class="draggable demo-no-swipe">
                  <th scope="row">Period 3</th>
                  <td>96</td>
                  <td>26</td>
                  <td>80%</td>
                  <td>5.7</td>
                  <td><span class="oi oi-pencil" title="pencil" aria-hidden="true"></span></td>
                  <td><span class="oi oi-trash" title="trash" aria-hidden="true" data-id="del-icon"></span></td>
                </tr>
                <tr class="draggable demo-no-swipe">
                  <th scope="row">Period 4</th>
                  <td>96</td>
                  <td>28</td>
                  <td>95%</td>
                  <td>5.8</td>
                  <td><span class="oi oi-pencil" title="pencil" aria-hidden="true"></span></td>
                  <td><span class="oi oi-trash" title="trash" aria-hidden="true" data-id="del-icon"></span></td>
                </tr>
                <tr class="demo-no-reorder">
                  <td colspan="7" class="demo-no-reorder"><button type="button" class="demo-no-reorder btn btn-success" style="width: 100%">Add period</button></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="col-lg-5"><img class="img-fluid img-plan" src="../spectrate/charts/chart1.png"></div>
        </div>
      </div>

      <div class="plan">
        <h2>Bulba - plan <span class="oi oi-trash oi-trash-period" title="trash" aria-hidden="true" id="del-plan-2"></span></h2>
        <div class="row">
          <div class="col-lg-7">
            <table class="table table-responsive table-striped plan">
              <thead>
                <tr>
                  <th scope="col">Parameters</th>
                  <th scope="col">Duration (hours): </th>
                  <th scope="col">Air temperature: </th>
                  <th scope="col">Humidity: </th>
                  <th scope="col">PH: </th>
                  <th colspan="2"></th>
                </tr>
              </thead>
              <tbody id="plan2">
                <tr class="draggable demo-no-swipe">
                  <th scope="row">Growing</th>
                  <td>120</td>
                  <td>10</td>
                  <td>88%</td>
                  <td>5.6</td>
                  <td><span class="oi oi-pencil" title="pencil" aria-hidden="true"></span></td>
                  <td><span class="oi oi-trash demo-no-reorder" title="trash" aria-hidden="true" data-id="del-icon"></span></td>
                </tr>
                <tr class="draggable demo-no-swipe">
                  <th scope="row">Flowering</th>
                  <td>96</td>
                  <td>25</td>
                  <td>86%</td>
                  <td>4</td>
                  <td><span class="oi oi-pencil" title="pencil" aria-hidden="true"></span></td>
                  <td><span class="oi oi-trash" title="trash" aria-hidden="true" data-id="del-icon"></span></td>
                </tr>

                <tr class="demo-no-reorder">
                  <td colspan="7" class="demo-no-reorder"><button type="button" class="demo-no-reorder btn btn-success" style="width: 100%">Add period</button></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="col-lg-5"><img class="img-fluid img-plan" src="../spectrate/charts/chart1.png"></div>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    <script type="text/javascript" src="../js/slip.js"></script>
    <script>
        function deleteRow(e) {
          var tr = e.target.parentNode.parentNode;
          var name = tr.children[0];
          name = (name.textContent?name.textContent:name.innerText);

          var t = confirm("You are going to delete period " + name + "!");
          if(t) {
            // tr.parentNode.focus();
            tr.parentNode.removeChild(tr);
          }
        }

        var counter = 5;
        function appendRow(e) {
          var tr = document.createElement("tr");
          tr.classList.add('draggable');
          tr.classList.add('demo-no-swipe');
          tr.innerHTML = '<th scope="row">Period ' + counter + '</th><td>96</td><td>28</td><td>95%</td><td>5.8</td><td><span class="oi oi-pencil" title="pencil" aria-hidden="true"></span></td><td><span class="oi oi-trash" title="trash" aria-hidden="true" data-id="del-icon"></span></td>';

          // tr = e.target.parentNode.parentNode.parentNode.appendChild(tr);
          e.target.parentNode.parentNode.parentNode.insertBefore(tr, e.target.parentNode.parentNode);
          counter++;
        } 

        function setupSlip(list) {
            var flag_dragging = false;
            list.addEventListener('mouseover', function(e){
              document.onselectstart = function(){ return false; }
            });
            list.addEventListener('mouseout', function(e){
              if(!flag_dragging){
                document.onselectstart = function(){ return true; }
              }
            });


            list.addEventListener('slip:beforereorder', function(e){
                flag_dragging = true;
                if (e.target.classList.contains('demo-no-reorder')) {
                    flag_dragging = false;
                    e.preventDefault();
                }
            }, false);

            list.addEventListener('slip:beforewait', function(e){
                var f = "ontouchstart" in document.documentElement;
                if(e.target.getAttribute('data-id') == 'del-icon') {
                    deleteRow(e);
                }
                if(e.target.type == 'button') {
                    appendRow(e);
                }
                if (!f) e.preventDefault();
            }, false);

            list.addEventListener('slip:beforeswipe', function(e){
                if (e.target.nodeName == 'INPUT' || e.target.parentNode.classList.contains('demo-no-swipe')) {
                    e.preventDefault();
                }
            }, false);

            list.addEventListener('slip:reorder', function(e){
                flag_dragging = false;
                e.target.parentNode.insertBefore(e.target, e.detail.insertBefore);
                return false;
            }, false);
            return new Slip(list);
        }
        
        setupSlip(document.getElementById('demo1'));
        setupSlip(document.getElementById('plan2'));

        document.getElementById('del-plan-1').addEventListener('click', function(e){
          if(confirm("OH SHHHH, U're going to delete Uour plan!!! Permanently!!! NaSoVsEm!!11!!!")) {
            e.target.parentNode.parentNode.style.display ='none';
          }
        });
        document.getElementById('del-plan-2').addEventListener('click', function(e){
          if(confirm("OH SHHHH, U're going to delete Uour plan!!! Permanently!!! NaSoVsEm!!11!!!")) {
            e.target.parentNode.parentNode.style.display ='none';
          }
        });


    </script>
  </body>
</html>